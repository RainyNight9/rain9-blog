# 站内信

## 背景

## 介绍

`“站内信”`不同于电子邮件，电子邮件通过专门的邮件服务器发送、保存，而`“站内信”`是系统内的消息，其实就是通过数据库插入记录来实现的。

站内信可以实现两个基本功能：

- 点到点的消息传送：用户给用户发送站内信，管理员给用户发送站内信；
- 点到面的消息传送：管理员给用户群发消息。

其实一句话总结，就是发消息通知。

### 消息通知的几种形式

消息通知，通常来说包括以下几种形式：

#### 1. 系统 PUSH，极高的曝光率&极低的打开率

IM 消息提醒、评论互动，运营通常采用这一方式。IM 消息提醒如微信、QQ、钉钉的聊天消息，对及时性的要求极高。互动评论常见于社交类应用，比如微博。

用户对这两者的容忍度相对较高，且 IM 消息 > 评论互动。

系统 PUSH 的优点在于它的到达率和曝光率，只要没有被关闭通知权限，几乎能够 100% 让用户看见。

这样的后果是打开率极低，并且一旦频繁推送，就面临着被用户关闭通知权限、甚至直接被卸载的后果。

#### 2. 应用内弹窗，重要的版本更新提示通常采用这种方式

京东的版本更新提示，饿了么每天首次打开时的红包，滴滴的活动推广……都会采用应用内弹窗。应用内弹窗的曝光率极高，但破坏性也极强，因为它打断了用户的正常使用流程，并且必须按关闭/确认才能关掉弹窗（更优雅的交互方式是点击屏幕空白处）。

#### 3. 站内信通知，取决产品本身的架构，通常由官方账号发出

站内信通知，是更为普遍的一种活动运营方式。

而 app 的日常运营，也是靠该账号推送内容，比如网易云音乐的小秘书、知乎的知乎团队/知乎 Live 团队。

#### 4. 小红点+浅灰色文字，通常标记在入口处

在功能入口上加小红点，在列表式的功能入口上加小红点/右侧浅灰色文字，是更常见的一种方式，比如微信默认朋友后有更新时会在发现栏上出现红点提示，以及微信读书的版本更新会在相应的入口处都添加小红点。

#### 5. 手机短信通知、邮件订阅

## 设计（站内信系统）

### 1. 消息列表（全部、已读、未读）

>用户可以看到，看到自己的有权限的消息

**筛选项：**

- 全部产品、各个子产品（10个）
- 全部消息类型、产品升级、系统通知、站内消息、异常公告、其他
- 全部等级、重要、一般
- 快速检索框

**表格：**

- 复选框（可以选择、标记已读等操作）
- 标题（点击可以查看详情）
- 时间
- 对应产品
- 消息类型
- 消息等级

### 2. 消息发布

>普通用户看不到，需要有系统管理权限或者对应产品权限的用户可以看到

**筛选项：**

- 全部产品、各个子产品（10个）
- 全部消息类型、产品升级、系统通知、站内消息、异常公告、其他
- 全部等级、重要、一般
- 全部状态、已发布、未发布、已暂停、已结束
- 快速检索框

**表格：**

- ID（唯一标识）
- 标题
- 对应产品
- 消息类型
- 消息等级
- 发布时间
- 已读/未读/暂停/结束（对应的用户数据量）
- 状态（已发布、未发布、已结束、已暂停）
- 操作（预览、复制、发布、暂停、继续、结束、编辑、删除）
  - 预览：重要信息 1比1 还原用户侧弹框展示，一般信息就是直接跳转详情页
  - 复制：复制一条相同的消息，可快速编辑修改
  - 发布：发布消息
  - 暂停：暂停发布消息任务，没收到消息用户暂时接受不到了
  - 继续：继续执行发布消息任务，让没有看到消息的用户可以接受到
  - 结束：结束这条发布消息任务，不发了，没看到的用户就不给看了
  - 编辑：编辑修改消息，和创建消息弹框一致
  - 删除：删除该条消息

**新增消息：**

- 产品类型选择（只发给对应的产品）
- 消息类型选择
- 等级类型（重要的是弹框、一般的是红点提示可去看详情）
- 定时发布时间（可选择发布消息的区间，用户只有在这段区间内接受到消息）
- 标题
- 内容（富文本输入框，可自行编辑）

### 3. 产品管理

>普通用户看不到，需要有系统管理权限可以看到

**表格：**

- ID（唯一 ID）
- 产品名称
- 产品描述
- 状态
- 创建人
- 创建时间
- 操作（编辑、删除）

**新增产品：**

- 产品名称
- 产品描述

### 4. 权限管理

>普通用户看不到，需要有系统管理权限可以看到

**筛选项：**

- 用户名
- 工号

**表格：**

- 用户名
- 工号
- 邮箱
- 对应产品
- 权限类型
- 操作（删除）

**新增授权：**

- 授权用户（快速检索公司内部用户）
- 权限类型（普通用户、管理员）
- 对应产品（各个子产品）

### 5. 消息通知

消息通知放在微前端应用的基座中，按照对应的产品，对应的去触发消息通知。是有目的，有分类，有分时间等去通知消息。

>如果是在基座中，接入了其他工具类，辅助类等接口 api，注意需要兼容接口 api接口错误处理，防止影响微前端主基座的核心功能。

**重要消息：**

展示方式为在时间范围内为强制弹框，机制是：只展示一次、用户点击“知道了”，或者关闭弹框都表示已读，不会第二次打扰用户。起到强制通知到用户，又避免了过多打扰用户。

**一般消息：**

右上角“消息”标记红点，提示给用户，用户想看就点进去列表，再进详情可查看对应消息。不强制用户读取。
